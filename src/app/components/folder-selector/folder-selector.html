<div class="folder-selector-container">
  <div class="content">
    <h1 class="title">Local TV</h1>
    <p class="subtitle">Tu canal personal de videos</p>

    @if (!isSupported) {
      <div class="error-box">
        <p>{{ error }}</p>
      </div>
    }

    @if (isSupported) {
      @if (!isLoading && !folderStates[0].selected) {
        <div class="action-box">
          <p class="instruction">Selecciona la primera carpeta con videos</p>
          <button class="select-button" (click)="onSelectFolder(0)">
            Seleccionar Primera Carpeta
          </button>
        </div>
      }

      @if (!isLoading && folderStates[0].selected && !folderStates[1].selected && videoCount > 0) {
        <div class="action-box">
          <p class="instruction">¡Encontramos {{ getTotalVideoCount() }} videos en la primera carpeta!</p>
          <p class="small-text">¿Quieres agregar una segunda carpeta opcional?</p>
          <div class="button-group">
            <button class="select-button secondary" (click)="onSelectSecondFolder()">
              Agregar Segunda Carpeta
            </button>
            <button class="skip-button" (click)="onSkipSecondFolder()">
              Continuar con {{ getTotalVideoCount() }} videos
            </button>
          </div>
        </div>
      }

      @if (isLoading) {
        <div class="loading-box">
          <div class="spinner"></div>
          <p class="loading-text">{{ loadingMessage }}</p>
          <div class="progress-bar">
            <div class="progress-fill" [style.width.%]="loadingProgress"></div>
          </div>
          <p class="progress-percentage">{{ loadingProgress }}%</p>
          <button class="cancel-button" (click)="cancelLoading()">
            Cancelar y seleccionar manualmente
          </button>
        </div>
      }

      @if (error && !isLoading) {
        <div class="error-box">
          <p>{{ error }}</p>
          <button class="retry-button" (click)="onSelectFolder(folderStates[0].selected ? 1 : 0)">
            Intentar de nuevo
          </button>
        </div>
      }

      @if (videoCount > 0 && !isLoading && folderStates[0].selected) {
        <div class="success-box">
          <p class="success-message">Se cargaron {{ getTotalVideoCount() }} videos</p>
          @if (folderStates[1].selected) {
            <p class="small-text">Carpeta 1: {{ folderStates[0].videoCount }} videos | Carpeta 2: {{ folderStates[1].videoCount }} videos</p>
          } @else {
            <p class="small-text">Iniciando reproducción...</p>
          }
        </div>
      }
    }
  </div>
</div>
