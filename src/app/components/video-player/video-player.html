<div class="video-container"
     (keydown)="onKeyPress($event)"
     (mousemove)="onMouseMove()"
     (mouseenter)="onMouseEnter()"
     (mouseleave)="onMouseLeave()"
     tabindex="0">
  @if (currentVideo) {
    <video
      #videoElement
      [src]="currentVideoUrl"
      (ended)="onVideoEnded()"
      (error)="onVideoError($event)"
      (loadeddata)="onVideoLoaded()"
      autoplay
      class="video-player">
    </video>
  }

  @if (error) {
    <div class="error-message">
      {{ error }}
    </div>
  }

  @if (isLoading) {
    <div class="loading-message">
      Cargando video...
    </div>
  }

  @if (showControls) {
    <div class="controls-overlay">
      <button class="change-folder-btn" (click)="onChangeFolder()">
        Cambiar Carpeta
      </button>
      <app-volume-control
        [volume]="volume"
        [isMuted]="isMuted"
        (volumeChange)="onVolumeChange($event)"
        (muteToggle)="onMuteToggle()">
      </app-volume-control>
      <app-subtitle-control
        [subtitles]="subtitles"
        [currentSubtitleIndex]="currentSubtitleIndex"
        (subtitleChange)="onSubtitleChange($event)">
      </app-subtitle-control>
      <app-audio-track-control
        [audioTracks]="audioTracks"
        [currentAudioIndex]="currentAudioIndex"
        (audioTrackChange)="onAudioTrackChange($event)">
      </app-audio-track-control>
    </div>
  }

  @if (showControls && currentVideo) {
    <app-video-info-overlay
      [videoName]="currentVideo.name"
      [showInfo]="showControls">
    </app-video-info-overlay>
  }

  @if (showControls && currentVideo) {
    <app-video-progress-bar
      [currentTime]="currentTime"
      [duration]="duration"
      (seek)="onSeek($event)">
    </app-video-progress-bar>
  }

  <app-overlay></app-overlay>
</div>
